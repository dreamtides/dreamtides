# INTRODUCTION

You are implementing the Lattice document management tool.

Primary design doc: @rules_engine/docs/lattice/lattice_design.md

Please complete exactly one task, provided below.

# YOUR TASK

{{TASK_BODY}}


# TASK TRACKING

Issue IDs with `dr-` prefix (e.g., `dr-l3x`) are `bd` issues. Close your task when complete.

- Track discovered work via `bd create` (see AGENTS.md for full command reference)
- Use TodoWrite for in-session progress tracking
- Do NOT run `bd sync`
- Do not modify files outside your task scope; file new beads instead


# ACCEPTANCE CRITERIA

## Code Style

Follow all rules in AGENTS.md. Key project-specific conventions:
- Function calls and enum values: exactly one qualifier (e.g., `move_card::run()`)
- Struct/enum type names: zero qualifiers (e.g., `BattleState`, not `battle::BattleState`)
- No `pub use` declarations
- No code in `mod.rs`/`lib.rs` except module declarations
- No `use` declarations inside function bodies

## Code Review

Review your work against @rules_engine/docs/lattice/appendix_code_review.md.

Critical points:
- Expected errors → `LatticeError`; system errors → `panic!` with reason
- Write high-quality, non duplicative tests
- Create high-quality, useful logs via `tracing`
- Functions < 50 lines, files < 500 lines
- Aggressively refactor code to remove duplication

## Completion Checklist

1. Run `just fmt` then `just review`
2. Create git commit with detailed description and a '# Manual Testing
   Instructions' commit message section (< 10 lines) with information about
   how to validate changes.
